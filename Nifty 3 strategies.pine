//@version=5

// Nifty 3 Strategies
// Last updated: 2025-09-30 06:29:25
// Updated by: saranghaeyokv-bot

// Original strategy logic (BB, Breakout, TBH)

// ... (existing code here) ...

// Barstate check for signals and alerts
if (barstate.isconfirmed)
    // Existing signal generation logic
    // Modify the signal generation to ensure it only triggers after candle closure

// Integrate ATR trailing stop logic for both TBH and Breakout strategies
atrLength = 14
atrMultiplier = 1.5
atr = ta.atr(atrLength)

// Example: TBH strategy trailing stop
var float tbTrailingStop = na
if (condition_for_TBH)
    tbTrailingStop := close - (atr * atrMultiplier)

// Example: Breakout strategy trailing stop
var float breakoutTrailingStop = na
if (condition_for_Breakout)
    breakoutTrailingStop := close - (atr * atrMultiplier)

// Keep all existing features intact

// ... (rest of the original logic and calculations) ...

// Update performance tracking

// ... (existing performance tracking code here) ...

// Overlap filters and time exclusions

// ... (existing overlap filters and time exclusions logic here) ...